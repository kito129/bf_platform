<!-- CARD 1-->
<div class="card">
  <!-- HEADER -->
  <div class="card-header">
    <div class="d-flex justify-content-between align-items-baseline">
      <h3 class="text-secondary">Strategy List</h3>

      <button type="button" [ngClass]="isCollapsed? 'btn btn btn-outline-primary' : 'btn btn btn-primary'" (click)="isCollapsed = !isCollapsed"
              [attr.aria-expanded]="!isCollapsed" aria-controls="collapseExample">
        View
      </button>

    </div>
  </div><!-- /HEADER -->
  <div class="card-body" ><!-- BODY -->
    <div [ngbCollapse]="isCollapsed">

      <div class="d-flex justify-content-space-between align-items-center">
        <div>
          <app-strategy-create-modal class="mr-2"
                                     (addStrategyCreateEmitter)="createModal($event)">
          </app-strategy-create-modal>
        </div>

        <div>
          <form class="form-group grid-margin">
            <div class="form-group">
              <!-- OPTIONS -->
              <label for="tableSize">Table size</label>
              <ng-select id="tableSize"
                         name="options"
                         [(ngModel)]="tableSize"
                         [items]="[5, 10,15,20,25,30,40,50,100,1000]"
                         [clearable]="false">
              </ng-select>
            </div>
          </form>
        </div>

        <div>
          <button type="button" class="btn btn ml-2"
                  [ngClass]="viewId ? 'btn-primary' : 'btn-outline-primary' "
                  (click)="viewId= !viewId">
            View Id
          </button>
        </div>

      </div>

      <ngx-datatable
        class="dark"
        [rows]="strategyDatatable"
        [loadingIndicator]="loadingIndicator"
        [columnMode]="ColumnMode.force"
        [headerHeight]="40"
        [footerHeight]="50"
        [limit]=tableSize
        rowHeight="auto"
        [reorderable]="true"
        [sorts]="[{prop: 'pl', dir: 'desc'}]">

        <ngx-datatable-column name="Id" prop="_id" [width]="3" *ngIf="viewId">
          <ng-template let-value="value" ngx-datatable-cell-template>
            <h5>{{ value }}</h5>
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column name="Name" prop="name" [width]="3">
          <ng-template let-value="value" ngx-datatable-cell-template>
            <h5>{{ value }}</h5>
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column name="Sport" prop="sport" [width]="1">
          <ng-template let-value="value" ngx-datatable-cell-template>
            <app-sport-text [sport]="value"></app-sport-text>
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column name="Year" prop="year" [width]="1">
          <ng-template let-value="value" ngx-datatable-cell-template>
            <h5 [ngClass]="value===2021 ? 'text-info' : 'text-light'">{{ value }}</h5>
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column name="# of Trade" prop="numberOfTrade" [width]="1">
          <ng-template let-value="value" ngx-datatable-cell-template>
            <h5>{{ value }}</h5>
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column name="Executor" prop="executor" [width]="1">
          <ng-template let-value="value" ngx-datatable-cell-template>
            <h5>{{ value}}</h5>
          </ng-template>
        </ngx-datatable-column>
        <!--
        <ngx-datatable-column name="Bank" prop="bank" [width]="1">
          <ng-template let-value="value" ngx-datatable-cell-template>
            <h5>{{ value | currency}}</h5>
          </ng-template>
        </ngx-datatable-column>


        <ngx-datatable-column name="Stake" prop="stake" [width]="1">
          <ng-template let-value="value" ngx-datatable-cell-template>
            <h5>{{ value | currency}}</h5>
          </ng-template>
        </ngx-datatable-column>
        -->

        <ngx-datatable-column name="Pl" prop="pl" [width]="3">
          <ng-template let-value="value" ngx-datatable-cell-template>
            <h4 [ngClass]="value>0 ? 'text-success' : value ===0 ? 'text-warning' : 'text-danger'">{{ value | currency }}</h4>
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column name="Pl %" prop="plPercent" [width]="1">
          <ng-template let-value="value" ngx-datatable-cell-template>
            <h5 class="text-primary">{{ value | percent }}</h5>
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column name="Max DD" prop="maxDD" [width]="1">
          <ng-template let-value="value" ngx-datatable-cell-template>
            <h5 class="text-danger">{{ value | currency }}</h5>
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column name="Max DD %" prop="maxDDPercent" [width]="1">
          <ng-template let-value="value" ngx-datatable-cell-template>
            <h5 class="text-danger">{{ value | percent }}</h5>
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column name="Win ratio" prop="winRatio" [width]="1">
          <ng-template let-value="value" ngx-datatable-cell-template>
            <h5 [ngClass]="value>0.60 ? 'text-success' : value>0.30 ? 'text-warning' : 'text-danger'">{{ value | percent }}</h5>
          </ng-template>
        </ngx-datatable-column>


        <ngx-datatable-column name="Tolls" prop=""  [width]="2">
          <ng-template let-value="value"  ngx-datatable-cell-template>

            <div class="d-flex justify-content-center align-items-center">

              <button type="button" class="btn btn-icon mr-2"
                      [ngClass]="selectedStrategyId === value._id ? 'btn-info' : 'btn-outline-info'"
                      (click)="clickSelectStrategy(value._id)"
                      [disabled]="value.numberOfTrade===0">
                <i class="feather icon-eye"></i>
              </button>

              <button type="button"
                      class="btn btn-icon mr-2"
                      [ngClass]="compareList.indexOf(value._id)===0 ? 'btn-warning': compareList.indexOf(value._id)!==-1 ? 'btn-success' : 'btn-outline-success'"
                      (click)="addToCompare(value._id)"
                      (contextmenu)="firstToCompare($event,value._id)">
                <i class="feather icon-plus-circle"></i>
              </button>

              <!--
              <app-delete-modal [id]="value.strategy._id"
                                [options]="'Delete'"
                                [type]="'strategy'"
                                (deleteEmitter)="deleteModal($event)">
              </app-delete-modal>
              -->



              <app-strategy-updates-modal [strategyInput$]="value.strategy"
                                          (strategyUpdateEmitter)="updateModal($event)">
              </app-strategy-updates-modal>
            </div>

          </ng-template>
        </ngx-datatable-column>

      </ngx-datatable>
    </div>
  </div>

  <div class="card-footer" *ngIf="!isCollapsed">
    <button type="button"
            class="btn btn-icon btn-icon-text mr-2"
            [ngClass]="compareStatus ? 'btn-primary' : 'btn-outline-primary' "
            (click)="compare()">
      <i class="btn-icon-prepend" data-feather="share-2" appFeatherIcon></i>
      Compare
    </button>
    <button type="button"
            class="btn btn-icon btn-outline-info btn-icon-text mr-2"
            (click)="compareAll()">
      <i class="btn-icon-prepend" data-feather="share-2" appFeatherIcon></i>
      Compare All
    </button>
    <button type="button"
            class="btn btn-icon btn-secondary btn-icon-text mr-2"
            (click)="resetCompare()">
      <i class="btn-icon-prepend" data-feather="rotate-cw" appFeatherIcon></i>
      Reset
    </button>
  </div>
</div>
