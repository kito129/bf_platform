<div class="d-flex align-items-center justify-content-end">
  <button type="button" class="btn btn-outline-light btn-icon-text mr-2 d-none d-md-block" (click)="saveAsCSV()">
    <i class="btn-icon-prepend" data-feather="download" appFeatherIcon></i>
    Download
  </button>
</div>

<ngx-datatable
  class="dark table-dark"
  [rows]="rows"
  [columnMode]="ColumnMode.standard"
  [headerHeight]="50"
  [footerHeight]="150"
  [rowHeight]="70"
  [scrollbarV]="true">

  <ngx-datatable-column name="Name" prop="studyName" [sortable]="true" [width]="280" [frozenLeft]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <p>{{ value }}</p>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Type" prop="studyName">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <div class="row">
        <h5 *ngIf="value.toLowerCase().indexOf('back')!==-1"><span class="badge badge-primary grid-margin mr-2">Back</span></h5>
        <h5 *ngIf="value.toLowerCase().indexOf('lay')!==-1"><span class="badge badge-danger grid-margin mr-2">Lay</span></h5>
        <h5 *ngIf="value.toLowerCase().indexOf('chunks')!==-1"><span class="badge badge-warning grid-margin">Chunks</span></h5>
      </div>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Match" prop="match" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5> {{ value }} </h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="PL" prop="pl" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5 [ngClass]="value>0 ? 'text-success' : value===0 ? 'text-warning' : 'text-danger'">{{ value | currency}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="WinRate %" prop="winRate" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5 [ngClass]="value<0.5 ? 'text-danger' : value<0.7 ? 'text-warning' : 'text-success'">
        {{value | percent:'0.2'}}
      </h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Win" prop="win" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{ value }} </h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Loss" prop="loss" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5> {{ value }} </h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Void" prop="void" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5> {{ value }}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="ProfitFactor" prop="profitFactor" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5 [ngClass]="value>1.3 ? 'text-success' : value>1 ? 'text-warning' : 'text-danger'">{{ value | number:'0.2'}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Profit Gross" prop="profitGross" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{ value | currency}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Loss Gross" prop="lossGross" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{ value | currency}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="EV" prop="expectedValue" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5 [ngClass]="value>0 ? 'text-success' : 'text-danger'">{{ value | currency}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="To Win To Break Even" prop="" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>
        {{-((1-value.winRate) * value.avgLoss) /  value.winRate  | currency}}
      </h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Avg Win" prop="avgWin" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h6>{{ value | currency}}</h6>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Avg Loss" prop="avgLoss" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h6> {{ value | currency}}</h6>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Max DD" prop="maxDD" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5> {{ value | currency }}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Max DD Percent" prop="maxDDPercent" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5 [ngClass]="value<-0.5 ? 'text-danger' : value<-0.25 ? 'text-warning' : 'text-success'"> {{ value | percent:'0.2'}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Avg DD" prop="avgDD" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5> {{ value | currency }}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Avg DD Percent" prop="avgDDPercent" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5 [ngClass]="value<-0.2 ? 'text-danger' : value<-0.10 ? 'text-warning' : 'text-success'"> {{ value | percent:'0.2'}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Stdv DD" prop="stdvDD" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5> {{ value | currency }}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Stdv DD Percent" prop="stdvDDPercent" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5 [ngClass]="value>0.15 ? 'text-danger' : value>0.07 ? 'text-warning' : 'text-success'"> {{ value | percent:'0.2'}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Avg Consec Profit" prop="avgConsecutiveWin" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5 [ngClass]="value>4 ? 'text-success' : value>2 ? 'text-warning' : 'text-danger'">{{ value | number:'0.2'}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Avg Consec Loss" prop="avgConsecutiveLoss" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5 [ngClass]="value>4 ? 'text-danger' : value>1.5 ? 'text-warning' : 'text-success'">{{ value | number: '0.2'}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Max Consec Win #" prop="maxConsecutiveWin" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{ value }}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Max Consec Loss #" prop="maxConsecutiveLoss" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{ value }}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Max Consec Profit €" prop="maxConsecutiveWinCash" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{ value | currency}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Max Consec Loss €" prop="maxConsecutiveLossCash" [sortable]="true">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{ value | currency}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <!--

  <ngx-datatable-footer>
    <ng-template
      ngx-datatable-footer-template
      let-rowCount="rowCount"
      let-pageSize="pageSize"
      let-selectedCount="selectedCount"
      let-curPage="curPage"
      let-offset="offset"
    >
      <div style="padding: 5px 10px">
        <div><strong>Summary</strong>: Gender: Female</div>
        <hr style="width:100%" />
        <div>Total Count: {{ rowCount }} | Total Pl: {{ pageSize }} | Current: {{ curPage }} | Offset: {{ offset }}</div>
      </div>
    </ng-template>
  </ngx-datatable-footer>

  -->

</ngx-datatable>

<div class="mt-2">
  <app-strategy-compare-charts [height]="500"
                               [strategyReports]="strategyReports"
                               [label]="strategyLabels">
  </app-strategy-compare-charts>
</div>


