<!-- SELECTED STATS-->
<div class="col">
  <app-trade-datatable-stats [selected]="selected"
                             [totalSize]=" rows.length">
    [totalSize]=" rows.length">
  </app-trade-datatable-stats>
</div>
<!-- SELECTED BUTTON-->
<div class="d-flex justify-content-center align-items-center">
  <button type="button"
          class="btn btn-outline-primary mr-3"
          (click)="selectAll()">
    Select All
  </button>
  <button type="button"
          [disabled]="selected.length===0"
          class="btn btn-outline-danger mr-4"
          (click)="unselectAll()">
    Unselect All
  </button>
  <button type="button"
          class="btn mr-3"
          [ngClass]="viewSelectedReport ? 'btn-info' : 'btn-outline-info'"
          (click)="generateReport()"
          [disabled]="selected.length===0">
    Generate Report
  </button>
  <app-strategy-report-save-modal *ngIf="selected.length>0"
                                  class="mr-4 ml-4"
                                  [selected]="selected"
                                  [title]="title"
                                  (saveReportEmitter)="saveReport($event)">
  </app-strategy-report-save-modal>
  <app-delete-modal [type]="'Trade'"
                    [ids]="selected"
                    [name]="' many '"
                    [options]="'Delete'"
                    (deleteEmitter)="deleteMany($event)">
  </app-delete-modal>
</div>


<!-- DATATABLE BUTTON -->
<div class="d-flex justify-content-end align-items-center">
  <button type="button" class="btn btn mr-2"
          [ngClass]="viewTrades ? 'btn-secondary' : 'btn-outline-secondary' "
          (click)="viewTrades= !viewTrades">
    View Trades
  </button>
  <button type="button" class="btn btn mr-2"
          [ngClass]="!viewResult ? 'btn-secondary' : 'btn-outline-secondary' "
          (click)="viewResult= !viewResult">
    View Result
  </button>
  <button type="button" class="btn btn mr-2"
          [ngClass]="viewOdds ? 'btn-secondary' : 'btn-outline-secondary' "
          (click)="viewOdds= !viewOdds">
    View Odds
  </button>
  <button type="button" class="btn btn mr-2"
          [ngClass]="viewStatsService ? 'btn-primary' : 'btn-outline-primary' "
          (click)="viewStatsService= !viewStatsService">
    Stats Service & Break
  </button>
  <button type="button" class="btn btn mr-2"
          [ngClass]="viewStatsSet ? 'btn-primary' : 'btn-outline-primary' "
          (click)="viewStatsSet= !viewStatsSet">
    Stats Set
  </button>
  <button type="button" class="btn btn mr-2"
          [ngClass]="viewStatsLeaderboard ? 'btn-primary' : 'btn-outline-primary' "
          (click)="viewStatsLeaderboard= !viewStatsLeaderboard">
    Stats Leaderboard
  </button>
  <form class="form-group grid-margin">
    <div class="row ">
      <div class="col">
        <div class="form-group">
          <label for="name">Find by Name</label>
          <input
            class="form-control"
            type="text"
            id="name"
            placeholder="Type name..."
            [(ngModel)]="search"
            name="search"
            (ngModelChange)="updateFilter()"/>
        </div>
      </div>
      <div class="col">
        <div class="form-group">
          <!-- OPTIONS -->
          <label for="tableSize">Table size</label>
          <ng-select id="tableSize"
                     name="options"
                     [(ngModel)]="tableSize"
                     [items]="[5, 10,15,20,25,30,40,50,100,200,250,500,1000]"
                     [clearable]="false">
          </ng-select>
        </div>
      </div>
    </div>
  </form>
</div>
<!-- DATA TABLE -->
<ngx-datatable
  class="dark"
  [rows]="rows"
  [columnMode]="ColumnMode.force"
  [rowHeight]="'auto'"
  [headerHeight]="40"
  [footerHeight]="50"
  [limit]="tableSize"
  [scrollbarH]="true"
  [selected]="selected"
  [selectionType]="SelectionType.multiClick"
  (select)="onSelect($event)"
  [sorts]="[{prop: 'trade.trade.info.date', dir: 'desc'}]">

  <ngx-datatable-column name="Date" prop="trade.trade.info.date" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{ value | date:'shortDate'}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Name" prop="trade.trade.info.marketInfo.marketName">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{ value }}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Result" prop="trade.trade.results.finalScore.tennis" [width]="1" *ngIf="!viewResult">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{ value | tennisPoint }}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="PL" prop="trade.trade.results.netProfit" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5 [ngClass]="value>0? 'text-success' : 'text-danger'">{{ value | currency }}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Stock" prop="data.stockPl" *ngIf="!viewTrades && !(viewStatsLeaderboard || viewStatsSet || viewStatsService)" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5 [ngClass]="value>0? 'text-success' : 'text-danger'">{{ value | currency }}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Risk" prop="trade.trade.results.maxRisk" *ngIf="!viewTrades && !(viewStatsLeaderboard || viewStatsSet || viewStatsService)" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5 class="text-warning">{{ value | currency }}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="A BSP" prop="bsp.runnerA" *ngIf=" (viewOdds  && (!viewTrades && !(viewStatsLeaderboard || viewStatsSet || viewStatsService)))" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <app-bsp-odd [bspOdd]="value"></app-bsp-odd>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="B BSP" prop="bsp.runnerB" *ngIf=" (viewOdds  && (!viewTrades && !(viewStatsLeaderboard || viewStatsSet || viewStatsService)))" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <app-bsp-odd [bspOdd]="value"></app-bsp-odd>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="A Back" prop="avgBets.back.runnerA" *ngIf=" (viewOdds  && (!viewTrades && !(viewStatsLeaderboard || viewStatsSet || viewStatsService)))" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5 class="text-primary" *ngIf="value>1.01">{{ value | number:'1.0-2'}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="A Lay" prop="avgBets.lay.runnerA" *ngIf=" (viewOdds  && (!viewTrades && !(viewStatsLeaderboard || viewStatsSet || viewStatsService)))" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5 class="text-danger" *ngIf="value>1.01">{{ value| number:'1.0-2'}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="B Back" prop="avgBets.back.runnerB" *ngIf=" (viewOdds  && (!viewTrades && !(viewStatsLeaderboard || viewStatsSet || viewStatsService)))" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5 class="text-primary" *ngIf="value>1.01">{{ value| number:'1.0-2'}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="B Lay" prop="avgBets.lay.runnerB" *ngIf=" (viewOdds  && (!viewTrades && !(viewStatsLeaderboard || viewStatsSet || viewStatsService)))" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5 class="text-danger" *ngIf="value>1.01">{{ value| number:'1.0-2'}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="rR" prop="trade.trade.results.rr" *ngIf="!viewTrades && !(viewStatsLeaderboard || viewStatsSet || viewStatsService)" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5 class="text-info">{{ value | percent: '.2' }}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Trades #" prop="trade.trade.trades.length" *ngIf="!viewTrades && !(viewStatsLeaderboard || viewStatsSet || viewStatsService)" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{ value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="A Service Hold %" prop="trade.trade.statistic.runnerA.stats1" *ngIf="viewStatsService" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="B Service Hold %" prop="trade.trade.statistic.runnerB.stats1" *ngIf="viewStatsService" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="A Return Games W%" prop="trade.trade.statistic.runnerA.stats2" *ngIf="viewStatsService" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="B Return Games W%" prop="trade.trade.statistic.runnerB.stats2" *ngIf="viewStatsService" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="A Break Back %" prop="trade.trade.statistic.runnerA.stats3" *ngIf="viewStatsService" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="B Break Back %" prop="trade.trade.statistic.runnerB.stats3" *ngIf="viewStatsService" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="A Win S1, wins in 2 %" prop="trade.trade.statistic.runnerA.stats4" *ngIf="viewStatsSet" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="B Win S1, wins in 2 %" prop="trade.trade.statistic.runnerB.stats4" *ngIf="viewStatsSet" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="A Lost set 1, won set 2 %" prop="trade.trade.statistic.runnerA.stats5" *ngIf="viewStatsSet" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="B Lost set 1, won set 2 %" prop="trade.trade.statistic.runnerB.stats5" *ngIf="viewStatsSet" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="A Set & Break win %" prop="trade.trade.statistic.runnerA.stats6" *ngIf="viewStatsSet" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="B Set & Break win 2 %" prop="trade.trade.statistic.runnerB.stats6" *ngIf="viewStatsSet" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="A Current rank" prop="trade.trade.statistic.runnerA.stats7" *ngIf="viewStatsLeaderboard" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="B Current rank" prop="trade.trade.statistic.runnerB.stats7" *ngIf="viewStatsLeaderboard" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="A Highest Carrer rank" prop="trade.trade.statistic.runnerA.stats8" *ngIf="viewStatsLeaderboard" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="B Highest Carrer rank" prop="trade.trade.statistic.runnerB.stats8" *ngIf="viewStatsLeaderboard" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="A TP Surface rank" prop="trade.trade.statistic.runnerA.stats9" *ngIf="viewStatsLeaderboard" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="B TP Surface rank" prop="trade.trade.statistic.runnerB.stats9" *ngIf="viewStatsLeaderboard" [width]="1">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <h5>{{value}}</h5>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Trades" prop="trade" *ngIf="viewTrades" [width]="900">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <app-trade-bets-view [trade]="value">
      </app-trade-bets-view>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="View" prop="">
    <ng-template let-value="value" ngx-datatable-cell-template>
      <app-trade-tools-actions [trade]="value.trade">

      </app-trade-tools-actions>
    </ng-template>
  </ngx-datatable-column>


</ngx-datatable>

<!-- SELECTED REPORT-->
<div *ngIf="viewSelectedReport && bug" class="mt-2">
  <app-strategy-report [selectedStrategyTrades$]="selectedTrades"
                       [selectedStrategy]="null"
                       [title]="'Selected'"
                       [bank]="100000">
  </app-strategy-report>
</div>
